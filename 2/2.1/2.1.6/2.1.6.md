# 2.1.6. Lista Consolidado

## üìò Requisitos Funcionales ‚Äî Sistema LYRA

El siguiente cuadro presenta el listado completo de **Requisitos Funcionales** del sistema **LYRA**, organizados por m√≥dulo y codificados seg√∫n su √°mbito funcional. Cada requisito describe la funcionalidad esperada del sistema, su prop√≥sito dentro de la experiencia del usuario y el criterio de aceptaci√≥n que determina cu√°ndo se considera correctamente implementado.

| C√≥digo | Nombre | Descripci√≥n | Criterio de Aceptaci√≥n |
|:--------|:--------|:-------------|:------------------------|
| **RF-PL-01** | Ingesta de selfie | El sistema permite tomar o cargar una selfie y obtiene la emoci√≥n principal. | Dado que el usuario autoriza c√°mara/galer√≠a, cuando captura/carga una imagen v√°lida, el sistema devuelve una emoci√≥n en <2s (p75) y muestra etiqueta + confianza. |
| **RF-PL-02** | Selecci√≥n manual de emoci√≥n | El usuario puede elegir su estado de √°nimo desde un selector. | Al elegir una emoci√≥n, el sistema salta el an√°lisis de imagen y contin√∫a al mapeo musical. |
| **RF-PL-03** | Normalizaci√≥n de emoci√≥n | Traduce la emoci√≥n a par√°metros musicales (tempo, energy, valence, danceability, acousticness). | Dado feliz, entonces valence ‚â• 0.7, energy ‚â• 0.6 (rango configurable). |
| **RF-PL-04** | Reglas por preferencia | Aplica filtros por g√©neros favoritos, idioma, d√©cada y duraci√≥n objetivo. | Si el usuario fij√≥ 30 min y rock/indie, la lista cumple duraci√≥n ¬±10% y ‚â•80% de tracks en esos g√©neros. |
| **RF-PL-05** | Semilla h√≠brida | Usa mezcla de emoci√≥n ‚Üí features + top artists/genres del usuario + pistas trending. | Playlist contiene ‚â•60% recomendaciones por features y ‚â•20% basadas en historial. |
| **RF-PL-06** | Pre-escucha y edici√≥n r√°pida | Permite reproducir 30s y reemplazar una pista por otra sugerida. | Al pulsar ‚ÄúCambiar‚Äù, el sistema ofrece ‚â•5 alternativas compatibles. |
| **RF-PL-07** | Guardado y versionado | Cada generaci√≥n crea un snapshot con emoci√≥n, hora, par√°metros y seed tracks. | La playlist queda guardada en historial con ID √∫nico y exportable a Spotify. |
| **RF-PL-08** | Re-generaci√≥n inteligente | El bot√≥n ‚ÄúRe-intentar‚Äù recalcula con variaci√≥n de semillas ¬±15%. | ‚â•70% de las pistas cambian respecto a la versi√≥n previa. |
| **RF-PL-09** | Compartir social | Genera cover (arte + emoci√≥n + c√≥digo QR/Deep Link) y texto pre-armado. | Compartir disponible para IG Stories, TikTok, X, WhatsApp. |
| **RF-PL-10** | Manejo de errores | Si falla la detecci√≥n, ofrece selecci√≥n manual sin perder progreso. | El usuario siempre puede completar la generaci√≥n. |
| **RF-PL-11** | L√≠mite por plan | Controla l√≠mites seg√∫n plan (Free/Premium). | Al exceder cuota, se muestra CTA a upgrade. |
| **RF-PL-12** | Telemetr√≠a √©tica | Registra datos anonimizados de emoci√≥n, duraci√≥n, skips y completion rate. | Datos se asocian a un session_id no sensible. |
| **RF-PL-13** | Multimodal visual | UI cambia fondo/animaci√≥n seg√∫n emoci√≥n. | Cada emoci√≥n tiene un tema visual asignado. |
| **RF-PL-14** | Seed local | Ajusta tempo/energy seg√∫n hora y clima. | Por la noche, energ√≠a base -10% salvo ‚Äúfiesta/energ√©tico‚Äù. |
| **RF-AU-01** | Registro con email y contrase√±a | Formulario con validaci√≥n fuerte y verificaci√≥n por correo. | Contrase√±a ‚â•8 chars, 1 may√∫scula, 1 n√∫mero; email de verificaci√≥n v√°lido 15 min. |
| **RF-AU-02** | Inicio de sesi√≥n social | Login con Spotify, Google y Apple. | Al autorizar, se crea/une perfil y se inicia sesi√≥n v√°lida por ‚â•30 d√≠as. |
| **RF-AU-03** | Recuperaci√≥n de cuenta | Flujo ‚ÄúOlvid√© mi contrase√±a‚Äù. | Se env√≠a enlace de reset con token 15 min; al usarlo, exige nueva contrase√±a. |
| **RF-AU-04** | Perfil de usuario | Edici√≥n de alias, foto, pa√≠s, idioma y visibilidad. | Cambios reflejan en todos los dispositivos en <2s (p75). |
| **RF-AU-05** | Diario y l√≠nea de tiempo | Historial de playlists con fecha, emoci√≥n, duraci√≥n y feedback. | Permite filtrar por emoci√≥n/fechas; al tocar √≠tem, abre detalle. |
| **RF-AU-06** | Panel de privacidad | Configura visibilidad e inclusi√≥n en ranking/feeds. | Si historial privado = ON, no se expone p√∫blicamente. |
| **RF-AU-07** | Gesti√≥n de sesiones | Muestra dispositivos activos y permite cierre remoto. | Al cerrar todas, invalida tokens excepto el actual. |
| **RF-AU-08** | Consentimientos informados | Captura granular y versionada de permisos. | Usuario puede revocar/otorgar; cambios quedan auditados. |
| **RF-AU-09** | Exportaci√≥n de datos | Descarga del historial en JSON/CSV. | Archivo incluye playlists, emociones, timestamps y par√°metros. |
| **RF-AU-10** | Eliminaci√≥n de cuenta | Soft-delete 30 d√≠as y hard-delete despu√©s. | Durante 30 d√≠as puede reactivar; luego se purga. |
| **RF-AU-11** | Seguridad de acceso | Rate limiting, detecci√≥n de fuerza bruta y 2FA opcional. | Tras 5 intentos fallidos, bloqueo 15 min; con 2FA se pide c√≥digo v√°lido. |
| **RF-AU-12** | Notificaciones | Push/email para novedades o recomendaciones. | Usuario puede suscribirse/desuscribirse por tipo. |
| **RF-AU-13** | Accesibilidad | Cumplimiento WCAG AA en formularios/timeline. | Navegaci√≥n por teclado y lector de pantalla operativos. |
| **RF-SB-01** | Cat√°logo de planes | Muestra Free vs Premium con beneficios. | UI muestra diferencias en playlists/d√≠a, estad√≠sticas, exportaciones. |
| **RF-SB-02** | Checkout seguro | Cobro con pasarela e impuestos. | Al pagar, se registra transacci√≥n exitosa y plan=Premium. |
| **RF-SB-03** | Renovaci√≥n autom√°tica | Cobro mensual recurrente con aviso previo. | Si se aprueba, extiende vigencia 30 d√≠as. |
| **RF-SB-04** | Gesti√≥n de m√©todo de pago | Permite agregar/quitar tarjeta y definir por defecto. | Reemplazo actualiza cobros futuros. |
| **RF-SB-05** | Dunning (reintentos) | Reintentos autom√°ticos ante fallo de cobro. | Tras 3 fallos (1h, 24h, 72h), pasa a ‚Äúen gracia‚Äù. |
| **RF-SB-06** | Grace period | 7 d√≠as de gracia antes de degradar plan. | Pasado el periodo, pasa a Free. |
| **RF-SB-07** | Cambio de plan y prorrata | Upgrade/downgrade con ajuste proporcional. | Usuario ve monto prorrateado antes de confirmar. |
| **RF-SB-08** | Cancelaci√≥n | Cancela al final del ciclo. | Mantiene beneficios hasta la fecha de corte. |
| **RF-SB-09** | Reembolsos | Reembolsos parciales o totales seg√∫n pol√≠tica. | Se registra nota de cr√©dito y correo de confirmaci√≥n. |
| **RF-SB-10** | Enforcements por plan | Controla l√≠mites y features por tipo de plan. | Free: m√°x. 2 playlists/d√≠a; Premium: ilimitado + estad√≠sticas. |
| **RF-SB-11** | Facturaci√≥n | Historial de pagos y comprobantes. | Lista fecha, importe, estado y PDF. |
| **RF-SB-12** | Promociones (futuro) | Cupones, trials y referidos. | Cup√≥n v√°lido refleja descuento en el total. |
| **RF-PF-01** | G√©neros y artistas favoritos | Multiselecci√≥n ponderada (1‚Äì5). | Pesos impactan seeds/targets de generaci√≥n. |
| **RF-PF-02** | Duraci√≥n objetivo | Selecci√≥n 15‚Äì120 min o personalizada. | Cumple objetivo ¬±10%. |
| **RF-PF-03** | Idioma y contenido expl√≠cito | Filtros por idioma y contenido. | Si expl√≠cito=OFF, excluye tracks marcados expl√≠citos. |
| **RF-PF-04** | D√©cadas/√©pocas | Preferencias por √©poca o ‚Äúnovedades‚Äù. | ‚â•80% de tracks coinciden con la(s) seleccionada(s). |
| **RF-PF-05** | Variabilidad (descubrimiento) | Slider ‚Äúdescubrir vs conocidos‚Äù. | En modo descubrir, ‚â•60% tracks no escuchados. |
| **RF-PF-06** | Ritmo del d√≠a | Perfiles Focus/Workout/Chill ajustan energ√≠a. | Al activar Workout, tempo/energy aumentan ‚â•15%. |
| **RF-PF-07** | Tema visual por emoci√≥n | Edici√≥n de temas visuales seg√∫n emoci√≥n. | Cada emoci√≥n renderiza su tema. |
| **RF-PF-08** | Sincronizaci√≥n cross-device | Preferencias sincronizadas en nube. | Cambios visibles en <2s (p75). |
| **RF-PF-09** | Reset r√°pido | Bot√≥n para restablecer preferencias. | Vuelve a valores por defecto con confirmaci√≥n. |
| **RF-PF-10** | Importar desde Spotify | Lee top artists/tracks del usuario. | Rellena g√©neros/artistas derivados autom√°ticamente. |
| **RF-IN-01** | OAuth con alcance m√≠nimo | Autorizaci√≥n con scopes m√≠nimos necesarios. | Guarda refresh token cifrado y fecha de expiraci√≥n. |
| **RF-IN-02** | Crear playlist en Spotify | Genera playlist ‚ÄúLYRA ‚Ä¢ <Emoci√≥n> ‚Ä¢ <fecha>‚Äù. | Playlist privada creada y rellenada con N pistas. |
| **RF-IN-03** | A√±adir/ordenar pistas | Inserci√≥n por lotes seg√∫n curva de energ√≠a. | Secuencia respeta progresi√≥n seleccionada. |
| **RF-IN-04** | Recomendaciones por features | Usa par√°metros target_* para recomendaci√≥n. | Respuesta logueada para auditor√≠a (sin datos sensibles). |
| **RF-IN-05** | Rate limiting y reintentos | Maneja 429/5xx con reintentos y backoff. | Tras 3 fallos, notifica al usuario. |
| **RF-IN-06** | Estado de conexi√≥n | Muestra estado y √∫ltimo refresh. | Si token expira, pide reautorizaci√≥n sin perder flujo. |
| **RF-IN-07** | Sincronizaci√≥n de ediciones | Aplica cambios locales a playlist remota. | Al sincronizar, refleja diferencias en Spotify. |
| **RF-IN-08** | Capa vendor-agnostic | Interfaz com√∫n para futuras integraciones. | Tests de contrato garantizan compatibilidad. |
| **RF-IN-09** | Manejo de errores/webhooks | Detecta expiraci√≥n o invalidaci√≥n de token. | Registra error con c√≥digo y timestamp. |
| **RF-IN-10** | Privacidad de playlist | Bandera p√∫blico/privado en creaci√≥n. | Valor elegido se respeta al crear playlist. |
