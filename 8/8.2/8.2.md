> [8. Aplicaci√≥n de Patrones Arquitecturales](../8.md) ‚Ä∫ [8.2. M√≥dulo Autenticaci√≥n y Usuarios / Pedro Morales](8.2.md)

# M√≥dulo Autenticaci√≥n y Usuarios / Pedro Morales

## üéØ Objetivo del Trabajo

Este trabajo busca documentar las decisiones clave tomadas a lo largo del desarrollo del **M√≥dulo de Autenticaci√≥n y Usuarios**, con un enfoque pr√°ctico y argumentado en la aplicaci√≥n de patrones arquitecturales. A trav√©s de este ADR, se busca fomentar la toma de decisiones arquitect√≥nicas informadas que favorezcan la seguridad, usabilidad, eficiencia y escalabilidad del sistema. 

El an√°lisis se realizar√° considerando las decisiones tomadas entre alternativas coherentes y aplicando patrones arquitecturales adecuados para garantizar la robustez y fiabilidad del sistema de autenticaci√≥n.

---

## ‚úèÔ∏è **Patrones de M√≥dulo**

### **Patr√≥n de M√≥dulo: Modularizaci√≥n basada en Microservicios**

**Alternativas Consideradas:**

- **Microservicios**: Utilizar una arquitectura de microservicios donde cada componente del sistema de autenticaci√≥n se maneje de forma independiente, facilitando la escalabilidad y el mantenimiento.

- **Monol√≠tico**: Mantener todo el sistema de autenticaci√≥n dentro de un √∫nico m√≥dulo monol√≠tico, centralizando todas las funcionalidades.


**Decisi√≥n:** Se ha optado por **Microservicios**.

**Raz√≥n de la Decisi√≥n:** La opci√≥n de **microservicios** permite que cada funci√≥n de autenticaci√≥n, como el registro de usuario, la autenticaci√≥n a trav√©s de redes sociales, y la gesti√≥n de contrase√±as, pueda escalar y actualizarse de forma independiente. Este enfoque mejora la **flexibilidad**, **escalabilidad** y el **mantenimiento** del sistema, lo que es clave para adaptarse a los cambios en los requerimientos y crecer con el tiempo.


**Aplicaci√≥n en el M√≥dulo:**
- El sistema de autenticaci√≥n se divide en varios microservicios, cada uno con una funcionalidad espec√≠fica: uno para el registro de usuarios, otro para la autenticaci√≥n social, otro para la gesti√≥n de contrase√±as, etc.


**Beneficio:**

- **Escalabilidad**: Cada servicio se puede escalar de forma independiente, lo que mejora el rendimiento a medida que el n√∫mero de usuarios crece.

- **Mantenimiento**: Los microservicios son independientes, lo que facilita su mantenimiento y actualizaci√≥n sin afectar al resto del sistema.

---

## üîë **Patrones de Componente y Conector**

### **Patr√≥n de Autenticaci√≥n Basado en Token (JWT)**

**Alternativas Consideradas:**
- **Autenticaci√≥n basada en sesi√≥n tradicional (cookies)**: Utilizar cookies para almacenar la sesi√≥n del usuario y mantener el estado de la sesi√≥n entre las solicitudes.
- **Autenticaci√≥n basada en token (JWT)**: Usar tokens de sesi√≥n generados al autenticar al usuario, los cuales se incluyen en cada solicitud subsecuente sin la necesidad de mantener el estado de sesi√≥n en el servidor.

**Decisi√≥n:** Se ha optado por **Autenticaci√≥n basada en token (JWT)**.

**Raz√≥n de la Decisi√≥n:** El uso de **JWT** es m√°s eficiente, ya que no requiere almacenamiento de sesi√≥n en el servidor, lo que mejora la **escalabilidad** y **seguridad**. Adem√°s, facilita la **integraci√≥n con APIs externas** y otros servicios que tambi√©n usen autenticaci√≥n basada en tokens, lo que proporciona una experiencia de usuario m√°s fluida.

**Aplicaci√≥n en el M√≥dulo:**
- Al iniciar sesi√≥n, el sistema genera un JWT para el usuario y lo utiliza para validar las futuras solicitudes de autenticaci√≥n.
  
**Beneficio:**
- **Escalabilidad**: Al no almacenar sesiones en el servidor, el sistema es m√°s f√°cil de escalar.
- **Seguridad**: El uso de JWT mejora la seguridad al reducir el riesgo de ataques de sesi√≥n, como XSS o CSRF.

---

## üåê **Patrones de Asignaci√≥n**

### **Patr√≥n de Gesti√≥n de Sesiones y Expiraci√≥n**

**Alternativas Consideradas:**
- **Expiraci√≥n Autom√°tica de Sesi√≥n**: Las sesiones se expiran despu√©s de un periodo de inactividad para proteger la seguridad del sistema.
- **Sesiones Permanentes**: Mantener la sesi√≥n activa indefinidamente, con cierre solo cuando el usuario se desconecte manualmente.

**Decisi√≥n:** Se ha optado por **Expiraci√≥n Autom√°tica de Sesi√≥n**.

**Raz√≥n de la Decisi√≥n:** La **expiraci√≥n autom√°tica de la sesi√≥n** mejora la **seguridad** al reducir el riesgo de que una sesi√≥n inactiva quede expuesta a accesos no autorizados. Si las sesiones permanecieran activas de forma indefinida, se podr√≠a poner en riesgo la seguridad del usuario en caso de que se olvide cerrar sesi√≥n en un dispositivo compartido o p√∫blico.

**Aplicaci√≥n en el M√≥dulo:**
- El sistema expira la sesi√≥n del usuario despu√©s de 30 minutos de inactividad y solicita reautenticaci√≥n.

**Beneficio:**
- **Seguridad**: Limita las oportunidades de acceso no autorizado al asegurar que las sesiones inactivas se cierren autom√°ticamente.

### **Patr√≥n de Gesti√≥n de Dispositivos**

**Alternativas Consideradas:**
- **Gesti√≥n de Dispositivos Locales**: Permitir que el usuario solo cierre sesi√≥n en el dispositivo en el que est√° trabajando.
- **Gesti√≥n de Dispositivos Globales**: Permitir que el usuario vea y cierre todas las sesiones activas en diferentes dispositivos.

**Decisi√≥n:** Se ha optado por **Gesti√≥n de Dispositivos Globales**.

**Raz√≥n de la Decisi√≥n:** La opci√≥n de **gesti√≥n global de dispositivos** permite al usuario **tener control total** sobre todas las sesiones activas de su cuenta. Esto es especialmente √∫til en situaciones de seguridad, como la p√©rdida o robo de un dispositivo, ya que el usuario puede cerrar todas sus sesiones desde cualquier dispositivo conectado.

**Aplicaci√≥n en el M√≥dulo:**
- El sistema muestra un panel donde el usuario puede ver todos los dispositivos en los que est√° activo y cerrar sesiones seleccionadas o todas las sesiones activas.

**Beneficio:**
- **Control total**: Los usuarios pueden gestionar sus sesiones en todos sus dispositivos, mejorando la seguridad y el control sobre sus cuentas.

---

## üå•Ô∏è **Patrones Cloud**

### **Patr√≥n de Interoperabilidad con Servicios Externos**

**Alternativas Consideradas:**
- **Integraci√≥n manual**: Los usuarios tendr√≠an que ingresar sus credenciales manualmente cada vez que se conecten a un servicio externo.
- **Integraci√≥n autom√°tica mediante APIs**: Usar APIs para integrar servicios externos de manera autom√°tica con el consentimiento del usuario.

**Decisi√≥n:** Se ha optado por **Integraci√≥n autom√°tica mediante APIs**.

**Raz√≥n de la Decisi√≥n:** La **integraci√≥n autom√°tica** facilita la **sincronizaci√≥n de datos** entre la aplicaci√≥n y servicios externos (como Spotify, Google Calendar, etc.) sin que el usuario tenga que ingresar sus credenciales cada vez. Esto mejora la experiencia del usuario y asegura la **interoperabilidad** con otros servicios populares.

**Aplicaci√≥n en el M√≥dulo:**
- Los usuarios pueden vincular sus cuentas con plataformas externas como Spotify, y la informaci√≥n se sincroniza autom√°ticamente con la aplicaci√≥n mediante APIs.

**Beneficio:**
- **Comodidad y eficiencia**: Permite a los usuarios sincronizar sus datos con facilidad y sin m√∫ltiples pasos de autenticaci√≥n.

---

## üéà Conclusiones

La aplicaci√≥n de estos patrones arquitecturales en el **M√≥dulo de Autenticaci√≥n y Usuarios** garantiza un sistema robusto y seguro. La modularizaci√≥n, el uso de JWT para la autenticaci√≥n, y el enfoque de integraci√≥n con servicios externos permiten que el sistema sea escalable y f√°cilmente mantenible.

**Patrones aplicados:**

- **JWT** para gesti√≥n de sesiones seguras.
- **Autenticaci√≥n Multifactor (MFA)** para mayor seguridad.
- **Expiraci√≥n de sesiones** para control de acceso.
- **Gesti√≥n de errores y retroalimentaci√≥n** para mejorar la experiencia de usuario.
- **Gesti√≥n de dispositivos** para mayor control de las sesiones.
- **Interoperabilidad con servicios externos** para ampliar funcionalidades.

Estos patrones contribuyen a un sistema adaptable que cubre los principales requerimientos de seguridad y usabilidad en la autenticaci√≥n y gesti√≥n de usuarios.

---

[‚¨ÖÔ∏è Anterior](../8.1/8.1.md) | [üè† Home](../../README.md) | [Siguiente ‚û°Ô∏è](../8.3/8.3.md)