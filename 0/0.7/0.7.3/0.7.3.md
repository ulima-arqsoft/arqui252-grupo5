> [0. Acerca del Grupo](../../0.md) â€º [0.7. Trabajo Individual (Patrones Cloud)](../0.7.md) â€º [0.7.3. Integrante 3](0.7.3.md)

# 0.7.3. Leonardo Salazar

# Desarrollo del patrÃ³n: Disyuntor (circuit breaker)

### Problema

En sistemas distribuidos o basados en microservicios, uno de los principales desafÃ­os es manejar las fallas intermitentes o caÃ­das temporales de servicios externos, como APIs de terceros, bases de datos o pasarelas de pago.  
Cuando un servicio externo deja de responder, las aplicaciones suelen seguir enviando solicitudes en bucle, lo que consume recursos innecesariamente, genera bloqueos, aumenta la latencia y puede provocar una caÃ­da en cascada del sistema.


---

### SoluciÃ³n

El patrÃ³n **disyuntor (circuit breaker)** propone un mecanismo que supervisa las llamadas a servicios externos y abre el circuito cuando detecta un nÃºmero determinado de fallos consecutivos.  
Al abrirse, el sistema bloquea temporalmente las nuevas solicitudes hacia el servicio fallido y devuelve una respuesta controlada o fallback.

DespuÃ©s de un tiempo preconfigurado, el circuito entra en modo semiabierto y permite una llamada de prueba:  
- Si la llamada tiene Ã©xito, el circuito vuelve a cerrarse.  
- Si falla, se mantiene abierto por otro intervalo.

De esta manera:
- Se evita la sobrecarga del servicio externo.  
- Se protege la estabilidad interna del sistema.  
- Se mantiene la experiencia del usuario con respuestas predecibles y seguras.

---

### Casos de AplicaciÃ³n

**Aplicaciones Fintech o E-commerce:**  
Plataformas que procesan pagos con servicios externos (Stripe, PayPal, MercadoPago) usan disyuntores para evitar que la caÃ­da de la pasarela afecte toda la aplicaciÃ³n.

**Sistemas de reservas o boletaje:**  
Cuando una API de terceros (aerolÃ­nea, hotel) estÃ¡ fuera de servicio, el disyuntor permite mostrar un mensaje al usuario sin detener el resto del sistema.

**Startups SaaS con microservicios:**  
En entornos donde varios microservicios dependen entre sÃ­ (facturaciÃ³n, usuarios, notificaciones), el disyuntor evita que un servicio lento bloquee a los demÃ¡s.

**Plataformas de streaming o contenido bajo demanda:**  
Si el servicio de recomendaciÃ³n o catÃ¡logo falla, el disyuntor devuelve una lista temporal o en cachÃ©, manteniendo la operatividad parcial sin afectar la experiencia del usuario.

---

### AplicaciÃ³n en el proyecto grupal

En el proyecto **Lyra**, dentro del **mÃ³dulo de gestiÃ³n de planes y suscripciones**, el patrÃ³n Disyuntor se implementarÃ¡ para **proteger las llamadas hacia la pasarela de pagos Stripe**.

**Flujo del proceso:**
1. El usuario premium ingresa sus datos de pago en un entorno seguro (*Stripe.js*), donde los datos son tokenizados cumpliendo el estÃ¡ndar **PCI-DSS**.  
2. El backend recibe el token y lo envÃ­a a Stripe a travÃ©s de un mÃ©todo protegido por el disyuntor.  
3. Si Stripe responde correctamente, el pago se confirma y se actualiza el estado de la suscripciÃ³n.  
4. Si Stripe no responde o arroja errores repetidos, el circuito se abre, evitando nuevos intentos por un tiempo definido (por ejemplo, 30 segundos).  
5. Durante ese tiempo, el sistema muestra un mensaje controlado al usuario:

> â€œEl servicio de pagos no estÃ¡ disponible temporalmente. Por favor, intÃ©ntalo mÃ¡s tarde.â€

6. Los **logs del disyuntor** registran el incidente, permitiendo un diagnÃ³stico rÃ¡pido por parte del equipo de soporte tÃ©cnico.

# Consideraciones tÃ©cnicas

Por completar
---

[â¬…ï¸ Anterior](../0.7.2/0.7.2.md) | [ğŸ  Home](../../../README.md) | [Siguiente â¡ï¸](../0.7.4/0.7.4.md)