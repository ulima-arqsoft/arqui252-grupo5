> [0. Acerca del Grupo](../../0.md) â€º [0.7. Trabajo Individual (Patrones Cloud)](../0.7.md) â€º [0.7.4. Integrante 4](0.7.4.md)

# 0.7.4. Carolina Meza

## **Patron retry**

# Problema
En sistemas distribuidos, muchas fallas son transitorias (latencia, timeouts, errores 5xx, lÃ­mites de tasa 429, pÃ©rdidas momentÃ¡neas de red). Si el cliente falla â€œde frenteâ€ o reintenta de inmediato y en masa, puede provocar tormentas de reintentos y agravar la indisponibilidad. El patrÃ³n Retry aborda precisamente el manejo de fallas transitorias para mejorar estabilidad y disponibilidad sin saturar la dependencia.

# SoluciÃ³n
La idea es envolver llamadas remotas con una polÃ­tica de reintentos que:
- Clasifica errores â€œretryableâ€ (p. ej., 408/429/5xx, errores de socket, lectura/escritura) versus no-reintentables (400, 401, 403, validaciones).
- Aplica exponential backoff con jitter (aleatoriedad) para evitar sincronizaciÃ³n de clientes (herd effect).
- Establece lÃ­mites (mÃ¡x. intentos y backoff mÃ¡ximo) y mÃ©tricas para observar el comportamiento.
- Se combina con timeouts y, si corresponde, circuit breaker para permitir recuperaciÃ³n del servicio.
- AWS recomienda exponential backoff + jitter (full/equal jitter) y documenta por quÃ© sin jitter los clientes se sincronizan; sus SDK ya incluyen estrategias estÃ¡ndar/adaptivas.
- Google Cloud enfatiza que idempotencia y retries van de la mano; varios servicios exigen backoff exponencial y orientan a marcar quÃ© operaciones son retryable.

# Casos de AplicaciÃ³n
**1. Fintech/e-commerce (Pagos y cobros)**
- **Problema:** confirmaciones de pago fallan por timeouts o 5xx del PSP.
- **AplicaciÃ³n:** reintentos con backoff + idempotency keys para evitar cargos duplicados; validar con mÃ©tricas de Ã©xito tras reintento. (Buenas prÃ¡cticas pÃºblicas de Google/Cloud Run y terceros sobre idempotencia en APIs como Stripe).

**2.APIs de plataforma de pagos/estÃ¡ndares de conectividad**
- **Problema:**polÃ­ticas del proveedor exigen retry con backoff y prohÃ­ben cachear errores.
- **AplicaciÃ³n:**  adoptar exponential backoff segÃºn lineamientos de la plataforma para cumplir SLAs y no sobrecargar

## AplicaciÃ³n en su Proyecto Grupal:
**MÃ³dulo GeneraciÃ³n de Playlist (Spotify):** Se implementa Retry con backoff exponencial + jitter para reintentar llamadas a la API de Spotify cuando ocurren fallas transitorias (timeouts, 429, 5xx). Antes, la creaciÃ³n de playlists fallaba en picos de demanda; con Retry e idempotency-key para evitar duplicados, se espera elevar la tasa de Ã©xito â‰¥ 99.5% y mantener p95 â‰¤ 1.2 s incluso ante rate limiting. La validaciÃ³n se harÃ¡ con k6 (inyectando 1â€“3% de timeouts/429) y monitoreo de retries_total, retry_reason y latencia p95 en el dashboard.

**IntegraciÃ³n con Plataformas Externas (Spotify):** Se habilita Retry respetando Retry-After cuando apliquen lÃ­mites de tasa, con circuit breaker para degradaciones sostenidas y fallback (una previsualizaciÃ³n local) si la dependencia no responde. Se espera mantener la disponibilidad â‰¥ 99.9% del flujo de â€œguardar playlistâ€ y que el breaker no permanezca abierto > 60 s. La validaciÃ³n se harÃ¡ con fallas inyectadas (429/5xx) y monitoreo de breaker_state, retry_delay_ms_sum y tasa de Ã©xito post-retry.

# Desarrollo de CÃ³digo y Demo


[â¬…ï¸ Anterior](../0.7.3/0.7.3.md) | [ğŸ  Home](../../../README.md) | [Siguiente â¡ï¸](../0.7.5/0.7.5.md)