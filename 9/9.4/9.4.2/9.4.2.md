> [9. Metodolog√≠a de Dise√±o de Arquitectura - Aplicaci√≥n de ADD](../../9.md) ‚Ä∫ [9.4. Iteraci√≥n 3: Refinar estructuras para abordar el atributo de calidad m√°s importante](../9.4.md) ‚Ä∫ [9.4.2. Elementos a refinar](9.4.2.md)

# 9.4.2. Elementos a refinar

# Elemento Principal a Refinar

El elemento principal es la **Gesti√≥n del Estado Persistente y Consistente** en relaci√≥n con el **historial del usuario** y el **estado de la suscripci√≥n**.

## Enfoque de Refinamiento: Event Sourcing y Servicio de Pol√≠ticas

Se emplear√°n los siguientes enfoques de refinamiento para garantizar la calidad:

- **Implementaci√≥n de Event Sourcing / Versionado (CRN02)**  
  El **Journal-Service** ser√° el responsable de recibir y almacenar de forma **inmutable** (como un snapshot) todos los eventos cr√≠ticos de generaci√≥n de playlists, garantizando que el **historial del usuario** sea un registro **auditable y consistente**.

- **Servicio de Pol√≠ticas (Subscription-Service)**  
  Este servicio centralizar√° la **l√≥gica de negocio sensible al plan** (Free vs. Premium).  
  Se dise√±ar√° un endpoint `CheckPermission(UserId, Action)` que el **API Gateway** consultar√° para aplicar los **l√≠mites de uso** (CU-SB-10) antes de que se gaste cualquier recurso.

- **Seguridad Delegada (ESC-10)**  
  Se refinar√° el **Subscription-Service** para que **no maneje informaci√≥n de tarjetas de cr√©dito**, delegando este riesgo completamente a un tercero (Stripe/Adyen) para el cumplimiento de **PCI-DSS**.


---

[‚¨ÖÔ∏è Anterior](../9.4.1/9.4.1.md) | [üè† Home](../../../README.md) | [Siguiente ‚û°Ô∏è](../9.4.3/9.4.3.md)